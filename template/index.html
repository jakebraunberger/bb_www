<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>BB</title>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
  </head>




  <body>
    
    <!-- Tab links -->
    <div class="tab">
      <button class="tablinks" onclick="openTab(event, 'Status')">Status</button>
      <button class="tablinks" onclick="openTab(event, 'Voltages')">Voltages</button>
      <button class="tablinks" onclick="openTab(event, 'Currents')">Currents</button>
      <button class="tablinks" onclick="openTab(event, 'Error Log')">Error Log</button>
    </div>




    <!-- Tab content -->
    <!-- Status -->
    <div id="Status" class="tabcontent">
      <table id="status-table" class="table">
          <tr> 
            <th> Name </th>
            <th> Value </th>
          </tr>
          <tr>
            <td> Status </td>
            <td> __status__ </td>
          </tr>
          <tr>
            <td> Battery Voltage </td>
            <td> __battery_voltage__ </td>
          </tr>
          <tr>
            <td> Array Voltage </td>
            <td> __array_voltage__ </td>
          </tr>
          <tr>
            <td> Load Voltage </td>
            <td> __load_voltage__ </td>
          </tr>
          <tr>
            <td> Charge Current </td>
            <td> __charge_current__ </td>
          </tr>
          <tr>
            <td> Load Current (A) </td>
            <td> __load_current__ </td>
          </tr>
          <tr>
            <td> Charge (W) </td>
            <td> __charge__ </td>
          </tr>
          <tr>
            <td> Daily Ah Charge </td>
            <td> __daily_ahc__ </td>
          </tr>
          <tr>
            <td> Daily Ah Load </td>
            <td> __daily_ahl__ </td>
          </tr>
          <tr>
            <td> Charge (kWh) </td>
            <td> __charge_kwh__ </td>
          </tr>
          <tr>
            <td> Daily Vb Min </td>
            <td> __daily_vb_min__ </td>
          </tr>
          <tr>
            <td> Charge State </td>
            <td> __charge_state__ </td>
          </tr>
          <tr>
            <td> CC LED State </td>
            <td> __cc_led_state__ </td>
          </tr>
          <tr>
            <td> MCC Firmware </td>
            <td> __mcc_firmware__ </td>
          </tr>
          <tr>
            <td> MCC SN </td>
            <td> __mcc_sn__ </td>
          </tr>
          <tr>
            <td> Drive RPM </td>
            <td> __drive_rpm__ </td>
          </tr>
          <tr>
            <td> Drive Status </td>
            <td> __drive_status__ </td>
          </tr>
          <tr>
            <td> Drive V </td>
            <td> __drive_v__ </td>
          </tr>
          <tr>
            <td> Drive Current (mA) </td>
            <td> __drive_current__ </td>
          </tr>
          <tr>
            <td> Drive Temperature </td>
            <td> __drive_temp__ </td>
          </tr>
      </table>
    </div>

    <!-- Voltages -->
    <div id="Voltages" class="tabcontent" style="width:50%">
      <canvas id="chart-voltage-battery" style="width:50%"></canvas>
      <canvas id="chart-voltage-array"></canvas>
      <canvas id="chart-voltage-load"></canvas>
    </div>

    <!-- Currents -->
    <div id="Currents" class="tabcontent" style="width:100%">
      <canvas id="chart-currents"></canvas>
    </div>

    

    <!-- Error Log -->
    <div id="Error Log" class="tabcontent" style="width:100%">
      <table id="error-table" class="table">
        <tr>
          <th> Time </th>
          <th> Error Name </th>
          <th> Error Value </th>
        </tr>
        
        <!-- todo: set on in Node.js, Socket.io -->
      </table>
      <!-- RPM, voltage, current, temp -->
      <canvas id="chart-mcc-rpm"></canvas>
      <canvas id="chart-mcc-voltage"></canvas>
      <canvas id="chart-mcc-current"></canvas>
      <canvas id="chart-mcc-temp"></canvas>
    </div>

    

    




    <!-- Script section -->
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="utils.js"></script>

    <!-- Tab things -->
    <script>
      function openTab(evt, cityName) {
        // Declare all variables
        var i, tabcontent, tablinks;

        // Get all elements with class="tabcontent" and hide them
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }

        // Get all elements with class="tablinks" and remove the class "active"
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        // Show the current tab, and add an "active" class to the button that opened the tab
        document.getElementById(cityName).style.display = "block";
        evt.currentTarget.className += " active";
      }
    </script>



    <!-- Dynamic things -->
    <script>
    // Get the status in human readable form
    

    // Chart Voltages
    var ctx_voltages = document.getElementById('chart-voltage-battery').getContext('2d');
    var myChartVoltages = new Chart(ctx_voltages, {
        type: 'line',
        data: {
        labels: __voltage_time__,
        datasets: [{ 
            data: __battery_voltage_data__,
            label: "Battery Voltage",
            borderColor: "#3e95cd",
            cubicInterpolation: 'default',
            fill: false
          }
        ]
      },
      options: {
        animation: {
          easing: 'easeInOutSine',
          duration: 0
        },
        title: {
          display: true,
          text: 'Battery Voltages'
        }
      }
    });

    var ctx_voltages_array = document.getElementById('chart-voltage-array').getContext('2d');
    var myChartVoltageArray = new Chart(ctx_voltages_array, {
        type: 'line',
        data: {
        labels: __voltage_time__,
        datasets: [{ 
            data: __array_voltage_data__,
            label: "Array Voltage",
            borderColor: "#3e95cd",
            cubicInterpolation: 'default',
            fill: false
          }
        ]
      },
      options: {
        animation: {
          easing: 'easeInOutSine',
          duration: 0
        },
        title: {
          display: true,
          text: 'Battery Voltages'
        }
      }
    });

    var ctx_voltages_load = document.getElementById('chart-voltage-load').getContext('2d');
    var myChartVoltageLoad = new Chart(ctx_voltages_load, {
        type: 'line',
        data: {
        labels: __voltage_time__,
        datasets: [{ 
            data: __load_voltage_data__,
            label: "Load Voltage",
            borderColor: "#3e95cd",
            cubicInterpolation: 'default',
            fill: false
          }
        ]
      },
      options: {
        animation: {
          easing: 'easeInOutSine',
          duration: 0
        },
        title: {
          display: true,
          text: 'Battery Voltages'
        }
      }
    });


    // Chart Currents
    var ctx_currents = document.getElementById('chart-currents').getContext('2d');
    var myChartCurrents = new Chart(ctx_currents, {
        type: 'line',
        data: {
        labels: __current_time__,
        datasets: [{ 
            data: [0,2,3,4,5,6,7,8,9,10],
            label: "Charge Current",
            borderColor: "#3e95cd",
            cubicInterpolation: 'default',
            fill: false
          },
          { 
            data: [1,2,3,4,5,6,7,8,9,10],
            label: "Load Current",
            borderColor: "#ff00cd",
            fill: false
        }
        ]
      },
      options: {
        animation: {
          easing: 'easeInOutSine',
          duration: 0
        },
        title: {
          display: true,
          text: 'Voltages'
        }
      }
    });









      



    </script>

      

      
     
      
    
  </body>
</html>